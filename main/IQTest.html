{{ block title }}
Questions
{{ endblock }}

{{ block content }}
<style>
    .question-list {
        list-style: none;
    }
    img {
        width: 12rem;
    }
</style>

<ul class="question-list">
    <li>{{ formfield "briefing_1" }}</li>
    <li>{{ formfield "briefing_2" }}</li>
    <li>{{ formfield "briefing_3" }}</li>
    <li>{{ formfield "briefing_4" }}</li>
    <li>{{ formfield "briefing_5" }}</li>
    <li>{{ formfield "briefing_6" }}</li>
    <li>{{ formfield "briefing_7" }}</li>
    <li>{{ formfield "briefing_8" }}</li>
    <li>{{ formfield "briefing_9" }}</li>
    <li>{{ formfield "briefing_10" }}</li>
    <li>{{ formfield "briefing_11" }}</li>
    <li>{{ formfield "briefing_12" }}</li>
    <li>{{ formfield "briefing_13" }}</li>
    <li>{{ formfield "briefing_14" }}</li>
    <li>{{ formfield "briefing_15" }}</li>
    <li>{{ formfield "briefing_16" }}</li>
    <li>{{ formfield "briefing_17" }}</li>
    <li>{{ formfield "briefing_18" }}</li>
    <li>{{ formfield "briefing_19" }}</li>
    <li>{{ formfield "briefing_20" }}</li>
</ul>

<div style="display: flex;justify-content: center;gap:1rem">
    <button class="btn btn-outline-primary" id="btn-prev">Prev</button>
    <button class="btn btn-outline-primary" id="btn-next">Next</button>
    <button class="otree-btn-next btn btn-primary" id="btn-submit" style="display: none;">Submit</button>
</div>

<script>
    $(() => {
        const $questions = $('.question-list li');
        const $submitButton = $('#btn-submit');
        const $prevButton = $('#btn-prev');
        const $nextButton = $('#btn-next');
        let currentIndex = 0;
        $questions.hide().first().show();

        const toggleSubmitButton = () => {
            if (currentIndex === $questions.length - 1) {
                $submitButton.show();
            } else {
                $submitButton.hide();
            }
        };

        const toggleNavigationButtons = () => {
            $prevButton.toggle(currentIndex > 0);
            $nextButton.toggle(currentIndex < $questions.length - 1);
        };

        const validateCurrentQuestion = () => {
            const $currentQuestion = $questions.eq(currentIndex);
            const $currentField = $currentQuestion.find('input:checked, select, textarea');
        
            // Remove any existing error messages
            $currentQuestion.find('.error-message').remove();
        
            if ($currentField.length === 0) {
            // Add error message
                const $errorMessage = $('<div class="error-message text-danger" style="color: red; margin-top: 5px;">Please answer this question</div>');
                $currentQuestion.append($errorMessage);
                return false;
            }
        
            return true;
        };

        $nextButton.click((e) => {
            e.preventDefault();
            
            if (!validateCurrentQuestion()) {
                // Use oTree's error handling
                const currentField = $questions.eq(currentIndex).find('input, select, textarea');
                window.otree.form.inputsWithErrors.push(currentField[0]);
                window.otree.form.showErrors();
                return;
            }

            if (currentIndex < $questions.length - 1) {
                $questions.eq(currentIndex).hide();
                currentIndex++;
                $questions.eq(currentIndex).show();
                toggleSubmitButton();
                toggleNavigationButtons();
            }
        });

        $prevButton.click((e) => {
            e.preventDefault();
            if (currentIndex > 0) {
                $questions.eq(currentIndex).hide();
                currentIndex--;
                $questions.eq(currentIndex).show();
                toggleSubmitButton();
                toggleNavigationButtons();
            }
        });

        // Initialize button states
        toggleSubmitButton();
        toggleNavigationButtons();
    });
</script>
{{ endblock }}